# 构建模型

## 划分训练集、测试集、验证集的依据

### **1. 单分类任务的特殊性**
单分类模型（如 One-Class SVM）的目标是**从正常数据（标签0）中学习分布规律**，将偏离此分布的样本视为异常（隐患）。因此：
- **训练集必须仅包含标签0样本**，避免污染正常模式的学习。
- **验证集和测试集需包含少量标签1样本**（已知隐患），用于评估模型对隐患的敏感性和误报率。

---

### **2. 关键考量维度**
#### **(1) 标签1样本的稀缺性**
- **标签1样本仅有61个**，远少于标签0样本（1164个）。
- **目标**：最大化利用标签1样本评估模型性能，避免因划分比例不当导致验证/测试集中隐患样本过少。
- **策略**：
  - 将标签1样本**优先分配给验证集和测试集**（而非训练集）。
  - 采用 **30%（验证集） + 70%（测试集）** 的划分，确保测试集有足够隐患样本（43个）进行最终评估。

#### **(2) 标签0样本的充足性**
- 标签0样本足够多（1164个），常规的 **80%（训练） + 20%（验证/测试）** 划分可行。
- **训练集需足够大**：80%的标签0样本（约931个）能充分学习正常社区的特征分布。
- **剩余20%的标签0样本**（233个）用于验证和测试，模拟真实场景中的“未知正常社区”。

#### **(3) 验证集与测试集的分工**
- **验证集**：需同时包含标签0和少量标签1样本（如18个），用于调参（如 `nu`, `gamma`），平衡召回率（隐患识别能力）与误报率。
- **测试集**：完全独立于训练和验证过程，需包含更多标签1样本（43个）以可靠评估泛化性能。

---

### **3. 比例设计的数学验证**
#### **(1) 标签1样本的分布**
- 验证集：`61 × 30% ≈ 18` 个标签1样本。
- 测试集：`61 × 70% ≈ 43` 个标签1样本。
- **合理性**：测试集的标签1样本足够计算召回率（如模型检测到30个隐患中的20个，召回率为66.7%），避免因样本过少导致指标波动。

#### **(2) 标签0样本的分布**
- 训练集：`1164 × 80% ≈ 931` 个。
- 验证集：`1164 × 20% × 50% ≈ 117` 个。
- 测试集：`1164 × 20% × 50% ≈ 117` 个。
- **合理性**：验证/测试集中的正常社区样本足够计算误报率（如模型误判117个中的10个，误报率为8.5%）。

#### **(3) 平衡评估指标的可信度**
- 若验证/测试集的标签1样本过少（如仅5个），召回率的置信区间会大幅波动（如检测到3个，召回率60%±40%），结果不可靠。
- 当前划分下，测试集43个标签1样本可使指标更稳定（如检测到30个，召回率70%±10%）。

---

### **4. 对比其他可能的划分方案**
#### **(1) 极端方案1：所有标签1样本给测试集**
- **问题**：验证集无标签1样本，无法调参优化模型对隐患的敏感性。
- **结果**：模型可能在测试集表现随机，无法可靠识别隐患。

#### **(2) 极端方案2：均匀分配标签1样本（如验证/测试各50%）**
- **问题**：测试集仅30个标签1样本，指标波动仍较大。
- **改进方向**：适当增加测试集比例（如70%）更合理。

#### **(3) 加入交叉验证（Cross-Validation）**
- **可行性**：由于标签1样本极少（61个），k-fold交叉验证会导致每折的标签1样本更少（如5-fold每折约12个），指标可能不稳定。
- **建议**：当前固定划分更适合小样本场景，可配合多次随机划分取平均值。

---

### **5. 实际落地建议**
- **多次随机划分取平均**：由于标签1样本稀缺，单次划分可能引入偏差，建议重复实验（如5次随机划分）并统计指标均值和方差。
- **人工审核辅助**：对模型预测的高风险社区（标签0中被判为异常）进行人工核查，逐步迭代优化标签质量。
- **特征重要性分析**：结合模型输出的特征权重，识别火灾隐患的核心影响因素（如电路老化、消防通道堵塞等），提升结果可解释性。

---

### **总结**
比例设计的核心是**优先保障模型对隐患（标签1）的识别能力**，同时充分利用标签0样本学习正常模式。通过权衡数据稀缺性、评估指标稳定性和模型调参需求，最终选择 **80%（训练）- 20%（验证/测试）** 的标签0划分和 **30%（验证）- 70%（测试）** 的标签1划分，以达到实际场景中的最优平衡。
